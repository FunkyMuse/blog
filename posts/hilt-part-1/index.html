<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hilt to the rescue, part 1" /><meta name="author" content="FunkyMuse" /><meta property="og:locale" content="en_US" /><meta name="description" content="Blog containing Kotlin and Android goodies." /><meta property="og:description" content="Blog containing Kotlin and Android goodies." /><link rel="canonical" href="https://funkymuse.github.io/posts/hilt-part-1/" /><meta property="og:url" content="https://funkymuse.github.io/posts/hilt-part-1/" /><meta property="og:site_name" content="FunkyMuse" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-17T18:55:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hilt to the rescue, part 1" /><meta name="twitter:site" content="@funky_muse" /><meta name="twitter:creator" content="@FunkyMuse" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"FunkyMuse"},"description":"Blog containing Kotlin and Android goodies.","url":"https://funkymuse.github.io/posts/hilt-part-1/","@type":"BlogPosting","headline":"Hilt to the rescue, part 1","dateModified":"2021-05-17T18:55:00+02:00","datePublished":"2021-05-17T18:55:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://funkymuse.github.io/posts/hilt-part-1/"},"@context":"https://schema.org"}</script><title>Hilt to the rescue, part 1 | FunkyMuse</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">FunkyMuse</a></div><div class="site-subtitle font-italic">Anything which inspires everything</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/apps/" class="nav-link"> <i class="fa-fw fas fa-mobile ml-xl-3 mr-xl-3 unloaded"></i> <span>APPLICATIONS</span> </a><li class="nav-item"> <a href="/hire_me/" class="nav-link"> <i class="fa-fw fas fa-code ml-xl-3 mr-xl-3 unloaded"></i> <span>HIRE ME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/FunkyMuse" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/funky_muse" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['funkymuse','protonmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hilt to the rescue, part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hilt to the rescue, part 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> FunkyMuse </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, May 17, 2021, 6:55 PM +0200" prep="on" > May 17 <i class="unloaded">2021-05-17T18:55:00+02:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2291 words">12 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/hilt/1/hilt_1.jpg" class="center" /></p><p>Hilt is a dependency injection library for Android that reduces the boilerplate of doing manual dependency injection in your project, it also means that Hilt is just an abstraction on top of Dagger2 and it gives us some of the goodies we’ve wrote already in the previous parts but we can safely delete them now.</p><p>In the previous posts (<a href="/posts/dagger-part-1/">Part #1</a>, <a href="/posts/dagger-part-2/">Part #2</a>, <a href="/posts/dagger-part-3/">Part #3</a>, <a href="/posts/dagger-part-4/">Part #4</a>, <a href="/posts/dagger-part-5/">Part #5</a>, <a href="/posts/dagger-part-6/">Part #6</a> and <a href="/posts/dagger-part-7/">Part #7</a>) about Dagger2, we’ve learnt that it ain’t that hard, Android runtime makes it, fast forwarding that to few months down the road, we’ve received Hilt 1.0.0 stable.</p><p>So far we’ve learnt about Modules, Submodules, Components and SubComponents, Scopes, custom Keys and MultiBindings.</p><h2 id="hilt-dependencies">Hilt Dependencies</h2><hr /><p>First we have to include the necessary dependencies (as of the date when this post was written)</p><p>In the project gradle</p><div class="language-groovy highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">ext</span> <span class="o">{</span>
    <span class="n">hiltJetpackVersion</span> <span class="o">=</span> <span class="s1">'1.0.0'</span>
    <span class="n">daggerVersion</span> <span class="o">=</span> <span class="s1">'2.35.1'</span>
<span class="o">}</span>
</pre></table></code></div></div><p>again in the project gradle file, add the classpath</p><div class="language-groovy highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">dependencies</span> <span class="o">{</span>
        <span class="n">classpath</span> <span class="s2">"com.google.dagger:hilt-android-gradle-plugin:$daggerVersion"</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>App’s gradle</p><div class="language-groovy highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>    <span class="c1">//dagger</span>
    <span class="n">implementation</span> <span class="s2">"com.google.dagger:dagger:$daggerVersion"</span>
    <span class="n">kapt</span> <span class="s2">"com.google.dagger:dagger-compiler:$daggerVersion"</span>

    <span class="c1">//hilt</span>
    <span class="n">implementation</span> <span class="s2">"com.google.dagger:hilt-android:$daggerVersion"</span>
    <span class="n">kapt</span> <span class="s2">"com.google.dagger:hilt-android-compiler:$daggerVersion"</span>

    <span class="c1">//hilt jetpack</span>
    <span class="n">implementation</span> <span class="s2">"androidx.hilt:hilt-navigation-fragment:$hiltJetpackVersion"</span>
    <span class="n">kapt</span> <span class="s2">"androidx.hilt:hilt-compiler:$hiltJetpackVersion"</span>

</pre></table></code></div></div><p>You can omit the hilt jetpack if you’re not using the jetpack components, in the following parts i’ll be talking about that too, so i’m including it beforehand.</p><p>Don’t forget to apply the gradle plugin id</p><div class="language-groovy highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">plugins</span> <span class="o">{</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="n">id</span> <span class="s1">'dagger.hilt.android.plugin'</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="setup">Setup</h2><hr /><p>One of the most important things to note when using hilt is <code class="language-plaintext highlighter-rouge">@HiltAndroidApp</code>, this is your entry point to your graph and has to be present in your <code class="language-plaintext highlighter-rouge">: Application</code>.</p><p>We can go ahead and change our previously written <code class="language-plaintext highlighter-rouge">DaggerIsEasyApplication</code> from</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">DaggerIsEasyApplication</span> <span class="p">:</span> <span class="nc">Application</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">applicationComponent</span><span class="p">:</span> <span class="nc">SingletonComponent</span>
        <span class="k">private</span> <span class="k">set</span>

    <span class="nd">@Inject</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">sharedPreferencesManager</span><span class="p">:</span> <span class="nc">SharedPreferencesManager</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">applicationComponent</span> <span class="p">=</span> <span class="nc">DaggerSingletonComponent</span><span class="p">.</span><span class="nf">factory</span><span class="p">().</span><span class="nf">create</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nf">also</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">provideGraphInside</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onCreate</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">sharedPreferencesManager</span><span class="p">.</span><span class="n">firstTimeLaunchSinceInstall</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="k">this</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">.</span><span class="n">simpleName</span><span class="p">,</span> <span class="s">"App is launched for the first time since installation time"</span><span class="p">)</span>
            <span class="n">sharedPreferencesManager</span><span class="p">.</span><span class="nf">appHasBeenLaunchedForTheFirstTime</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>to</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nd">@HiltAndroidApp</span>
<span class="kd">class</span> <span class="nc">DaggerIsEasyApplication</span> <span class="p">:</span> <span class="nc">Application</span><span class="p">()</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">sharedPreferencesManager</span><span class="p">:</span> <span class="nc">SharedPreferencesManager</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onCreate</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">sharedPreferencesManager</span><span class="p">.</span><span class="n">firstTimeLaunchSinceInstall</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="k">this</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">.</span><span class="n">simpleName</span><span class="p">,</span> <span class="s">"App is launched for the first time since installation time"</span><span class="p">)</span>
            <span class="n">sharedPreferencesManager</span><span class="p">.</span><span class="nf">appHasBeenLaunchedForTheFirstTime</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Hilt generates an entry point by just looking at the annotation we’ve just added, from there on Hilt generates a graph for your application, a graph that has a hierarchy of components <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://dagger.dev/hilt/component-hierarchy.svg" alt="Component's hierarch" /></p><h2 id="hilt-components">Hilt components</h2><p>The are the pre-defined components by the Hilt dependencies.</p><h3 id="singletoncomponent"><strong>SingletonComponent</strong></h3><hr /><p>Created when <code class="language-plaintext highlighter-rouge">onCreate</code> happens in your <code class="language-plaintext highlighter-rouge">: Application</code> terminated when <code class="language-plaintext highlighter-rouge">onDestroy</code> happens inside the application level, this is a parent component which means upon it’s destruction every other component that inherits from it, is destroyed with it.</p><p>This is where your singleton instances <em>will</em> live.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@Singleton</code> to annotate every dependency that lives here.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(SingletonComponent::class)</code> to include a module inside the component.</p><h3 id="activityretainedcomponent"><strong>ActivityRetainedComponent</strong></h3><hr /><p>ActivityRetainedComponent lives across configuration changes, so it is created at the first onCreate and last onDestroy it also inherits everything provided by the <strong>SingletonComponent</strong>, since it is it’s child.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">Activity</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@ActivityRetainedScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(ActivityRetainedComponent::class)</code> to include a module inside the component.</p><h3 id="servicecomponent"><strong>ServiceComponent</strong></h3><hr /><p>Created when <code class="language-plaintext highlighter-rouge">onCreate</code> happens inside the <code class="language-plaintext highlighter-rouge">Service</code> and destroyed when <code class="language-plaintext highlighter-rouge">onDestroy</code> happens, it also inherits everything provided by the <strong>SingletonComponent</strong>, since it is it’s child.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">Service</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@ServiceScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(ServiceComponent::class)</code> to include a module inside the component.</p><h3 id="activitycomponent"><strong>ActivityComponent</strong></h3><hr /><p>ActivityComponent <strong>DOESN’T</strong> across configuration changes, it is created on every <code class="language-plaintext highlighter-rouge">onCreate</code> and destroyed at <code class="language-plaintext highlighter-rouge">onDestroy</code> it also inherits everything provided by the <strong>SingletonComponent</strong>, since it is it’s child.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">Activity</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@ActivityScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(ActivityComponent::class)</code> to include a module inside the component.</p><h3 id="viewmodelcomponent"><strong>ViewModelComponent</strong></h3><hr /><p>Created when <code class="language-plaintext highlighter-rouge">onCreate</code> happens inside the <code class="language-plaintext highlighter-rouge">Activity</code> and cleared when <code class="language-plaintext highlighter-rouge">onDestroy</code> happens, it also inherits everything provided by the <strong>ActivityRetainedComponent</strong> (which inherits the Singleton), since it is it’s child.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">ViewModel</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@ViewModelScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(ViewModelComponent::class)</code> to include a module inside the component.</p><h3 id="fragmentcomponent"><strong>FragmentComponent</strong></h3><hr /><p>Created when <code class="language-plaintext highlighter-rouge">onAttach</code> happens and destroyed when <code class="language-plaintext highlighter-rouge">onDestroy</code> happens in the <code class="language-plaintext highlighter-rouge">Fragment</code>, it also inherits everything provided by the <strong>SingletonComponent</strong>, since it is it’s child.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">Fragment</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@FragmentScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(FragmentComponent::class)</code> to include a module inside the component.</p><h3 id="viewcomponent"><strong>ViewComponent</strong></h3><hr /><p>Created when <code class="language-plaintext highlighter-rouge">view.super()</code> happens and destroyed when the view is destroyed, it also inherits everything provided by the <strong>SingletonComponent</strong>, since it is it’s child.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">View</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@ViewScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(ViewComponent::class)</code> to include a module inside the component.</p><h3 id="viewwithfragmentcomponent"><strong>ViewWithFragmentComponent</strong></h3><hr /><p>Created when <code class="language-plaintext highlighter-rouge">view.super()</code> happens and destroyed when the view is destroyed, it also inherits everything provided by the <strong>SingletonComponent</strong>, since it is it’s child, you also have access to fragment bindings, this view must always be attached through a fragment.</p><p>Injector for your <code class="language-plaintext highlighter-rouge">View</code>.</p><p>You can use the scope <code class="language-plaintext highlighter-rouge">@ViewScoped</code> to annotate every dependency that will live within that scope.</p><p>You use <code class="language-plaintext highlighter-rouge">@InstallIn(ViewWithFragmentComponent::class)</code> to include a module inside the component.</p><p>For the fragment bindings <code class="language-plaintext highlighter-rouge">@WithFragmentBindings</code>.</p><p>By default, all bindings in Dagger are “unscoped”. This means that each time the binding is requested, Dagger will create a new instance of the binding.</p><p>When we say bindings we mean the dependencies you declare using <code class="language-plaintext highlighter-rouge">@Provides</code> and/or <code class="language-plaintext highlighter-rouge">@Binds</code>.</p><p>In order to access the scopes, in your <em>Activity</em>, <em>Fragment</em>, <em>Service</em>, <em>View</em> etc.. you must annotate the class with <code class="language-plaintext highlighter-rouge">@AndroidEntryPoint</code>.</p><h2 id="activity">Activity</h2><p>We had the following code</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">MainActivity</span> <span class="p">:</span> <span class="nc">AppCompatActivity</span><span class="p">()</span> <span class="p">{</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="nf">addOnContextAvailableListener</span> <span class="p">{</span> <span class="n">availableContext-</span><span class="p">&gt;</span>
            <span class="nf">injector</span> <span class="p">{</span>
                <span class="nf">activityComponentFactory</span><span class="p">().</span><span class="nf">create</span><span class="p">(</span><span class="n">availableContext</span><span class="p">).</span><span class="nf">also</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">inject</span><span class="p">(</span><span class="k">this</span><span class="nd">@MainActivity</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Inject</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">powerReceiver</span><span class="p">:</span> <span class="nc">PowerReceiver</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="nc">Bundle</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
        <span class="nf">setContentView</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">activity_main</span><span class="p">)</span>

        <span class="kd">val</span> <span class="py">filter</span> <span class="p">=</span> <span class="nc">IntentFilter</span><span class="p">(</span><span class="nc">Intent</span><span class="p">.</span><span class="nc">ACTION_POWER_CONNECTED</span><span class="p">).</span><span class="nf">also</span> <span class="p">{</span>
            <span class="n">it</span><span class="p">.</span><span class="nf">addAction</span><span class="p">(</span><span class="nc">Intent</span><span class="p">.</span><span class="nc">ACTION_POWER_DISCONNECTED</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">registerReceiver</span><span class="p">(</span><span class="n">powerReceiver</span><span class="p">,</span><span class="n">filter</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">savedInstanceState</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">supportFragmentManager</span>
                <span class="p">.</span><span class="nf">beginTransaction</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fragment_container</span><span class="p">,</span> <span class="nc">HomeFragment</span><span class="p">(),</span> <span class="s">"HomeFragment"</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>let’s convert it to Hilt.</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nd">@AndroidEntryPoint</span>
<span class="kd">class</span> <span class="nc">MainActivity</span> <span class="p">:</span> <span class="nc">AppCompatActivity</span><span class="p">()</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">powerReceiver</span><span class="p">:</span> <span class="nc">PowerReceiver</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="nc">Bundle</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
        <span class="nf">setContentView</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">activity_main</span><span class="p">)</span>

        <span class="kd">val</span> <span class="py">filter</span> <span class="p">=</span> <span class="nc">IntentFilter</span><span class="p">(</span><span class="nc">Intent</span><span class="p">.</span><span class="nc">ACTION_POWER_CONNECTED</span><span class="p">).</span><span class="nf">also</span> <span class="p">{</span>
            <span class="n">it</span><span class="p">.</span><span class="nf">addAction</span><span class="p">(</span><span class="nc">Intent</span><span class="p">.</span><span class="nc">ACTION_POWER_DISCONNECTED</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">registerReceiver</span><span class="p">(</span><span class="n">powerReceiver</span><span class="p">,</span><span class="n">filter</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">savedInstanceState</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">supportFragmentManager</span>
                <span class="p">.</span><span class="nf">beginTransaction</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fragment_container</span><span class="p">,</span> <span class="nc">HomeFragment</span><span class="p">(),</span> <span class="s">"HomeFragment"</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>and also delete the following: <em>ActivityComponent, ActivityContext, ActivityModule, ActivityScoped</em>.</p><h2 id="fragment">Fragment</h2><hr /><p>Let’s refactor our Fragment, which looks like this</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">HomeFragment</span> <span class="p">:</span> <span class="nc">Fragment</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">home_fragment</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onAttach</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="nc">Context</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">injector</span> <span class="p">{</span>
            <span class="nf">fragmentComponentFactory</span><span class="p">().</span><span class="nf">create</span><span class="p">().</span><span class="nf">inject</span><span class="p">(</span><span class="k">this</span><span class="nd">@HomeFragment</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onAttach</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Inject</span>
    <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">daggerViewModelFactory</span><span class="p">:</span> <span class="nc">ViewModelProvider</span><span class="p">.</span><span class="nc">Factory</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">testViewModel</span> <span class="k">by</span> <span class="n">viewModels</span><span class="p">&lt;</span><span class="nc">TestViewModel</span><span class="p">&gt;(){</span>
        <span class="n">daggerViewModelFactory</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onViewCreated</span><span class="p">(</span><span class="n">view</span><span class="p">:</span> <span class="nc">View</span><span class="p">,</span> <span class="n">savedInstanceState</span><span class="p">:</span> <span class="nc">Bundle</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onViewCreated</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">savedInstanceState</span><span class="p">)</span>
        <span class="n">viewLifecycleOwner</span><span class="p">.</span><span class="nf">addRepeatingJob</span><span class="p">(</span><span class="nc">Lifecycle</span><span class="p">.</span><span class="nc">State</span><span class="p">.</span><span class="nc">STARTED</span><span class="p">){</span>
            <span class="n">testViewModel</span><span class="p">.</span><span class="n">list</span><span class="p">.</span><span class="nf">collect</span> <span class="p">{</span>
                <span class="nf">handleAPICall</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">handleAPICall</span><span class="p">(</span><span class="n">simpleResult</span><span class="p">:</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;)</span> <span class="p">{</span>
        <span class="k">when</span><span class="p">(</span><span class="n">simpleResult</span><span class="p">){</span>
            <span class="k">is</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">ApiError</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"SimpleResult.ApiError"</span><span class="p">,</span> <span class="s">"Response code ${simpleResult.responseCode}"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">is</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Exception</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="k">when</span><span class="p">(</span><span class="n">simpleResult</span><span class="p">.</span><span class="n">throwable</span><span class="p">){</span>
                   <span class="k">is</span> <span class="nc">UnauthorizedInterceptor</span><span class="p">.</span><span class="nc">UnauthorizedException-</span><span class="p">&gt;{</span>
                       <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"Exception"</span><span class="p">,</span> <span class="s">"Log off"</span><span class="p">)</span>
                   <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Loading</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"SimpleResult.Loading"</span><span class="p">,</span> <span class="s">"SHOW SPINNER"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">is</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="kd">val</span> <span class="py">successData</span> <span class="p">=</span> <span class="n">simpleResult</span><span class="p">.</span><span class="n">data</span>
                <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"SimpleResult.Success"</span><span class="p">,</span> <span class="n">successData</span><span class="p">.</span><span class="nf">toString</span><span class="p">())</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>to</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="nd">@AndroidEntryPoint</span>
<span class="kd">class</span> <span class="nc">HomeFragment</span> <span class="p">:</span> <span class="nc">Fragment</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">layout</span><span class="p">.</span><span class="n">home_fragment</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">testViewModel</span> <span class="k">by</span> <span class="n">viewModels</span><span class="p">&lt;</span><span class="nc">TestViewModel</span><span class="p">&gt;()</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onViewCreated</span><span class="p">(</span><span class="n">view</span><span class="p">:</span> <span class="nc">View</span><span class="p">,</span> <span class="n">savedInstanceState</span><span class="p">:</span> <span class="nc">Bundle</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">.</span><span class="nf">onViewCreated</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">savedInstanceState</span><span class="p">)</span>
        <span class="n">viewLifecycleOwner</span><span class="p">.</span><span class="nf">addRepeatingJob</span><span class="p">(</span><span class="nc">Lifecycle</span><span class="p">.</span><span class="nc">State</span><span class="p">.</span><span class="nc">STARTED</span><span class="p">){</span>
            <span class="n">testViewModel</span><span class="p">.</span><span class="n">list</span><span class="p">.</span><span class="nf">collect</span> <span class="p">{</span>
                <span class="nf">handleAPICall</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">handleAPICall</span><span class="p">(</span><span class="n">simpleResult</span><span class="p">:</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;)</span> <span class="p">{</span>
        <span class="k">when</span><span class="p">(</span><span class="n">simpleResult</span><span class="p">){</span>
            <span class="k">is</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">ApiError</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"SimpleResult.ApiError"</span><span class="p">,</span> <span class="s">"Response code ${simpleResult.responseCode}"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">is</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Exception</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="k">when</span><span class="p">(</span><span class="n">simpleResult</span><span class="p">.</span><span class="n">throwable</span><span class="p">){</span>
                   <span class="k">is</span> <span class="nc">UnauthorizedInterceptor</span><span class="p">.</span><span class="nc">UnauthorizedException-</span><span class="p">&gt;{</span>
                       <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"Exception"</span><span class="p">,</span> <span class="s">"Log off"</span><span class="p">)</span>
                   <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Loading</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"SimpleResult.Loading"</span><span class="p">,</span> <span class="s">"SHOW SPINNER"</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">is</span> <span class="nc">TestViewModel</span><span class="p">.</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
                <span class="kd">val</span> <span class="py">successData</span> <span class="p">=</span> <span class="n">simpleResult</span><span class="p">.</span><span class="n">data</span>
                <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"SimpleResult.Success"</span><span class="p">,</span> <span class="n">successData</span><span class="p">.</span><span class="nf">toString</span><span class="p">())</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>and also delete the following: <em>FragmentComponent, FragmentModule, FragmentScoped</em>.</p><p>Also let’s delete <em>SingletonComponent</em> and <em>ApplicationContext</em> and our <em>DaggerExtensions.kt</em>.</p><p>Let’s go and delete more stuff: <em>DaggerViewModelFactory</em>, <em>ViewModelKey</em> and <em>ViewModelModule</em>.</p><p>Delete: <em>BroadcastComponent</em> and <em>BroadcastScoped</em> (we’ll get more on that later).</p><p>Now we do a little bit of adjusting to the <code class="language-plaintext highlighter-rouge">RetrofitModule</code>, we’ve had</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="nd">@Module</span>
<span class="kd">object</span> <span class="nc">RetrofitModule</span> <span class="p">{</span>


    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">moshiConverterFactory</span><span class="p">()</span> <span class="p">=</span> <span class="nc">MoshiConverterFactory</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>


    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">okHttpClientConfiguration</span><span class="p">(</span>
        <span class="n">interceptors</span><span class="p">:</span> <span class="nc">Set</span><span class="p">&lt;</span><span class="err">@</span><span class="nc">JvmSuppressWildcards</span> <span class="nc">Interceptor</span><span class="p">&gt;</span>
    <span class="p">):</span> <span class="nc">OkHttpClient</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">timeout</span> <span class="p">=</span> <span class="mi">10L</span> <span class="c1">//even this can be provided</span>
        <span class="kd">val</span> <span class="py">timeUnit</span> <span class="p">=</span> <span class="nc">TimeUnit</span><span class="p">.</span><span class="nc">SECONDS</span> <span class="c1">//even this too, but for the sake of keeping this short we  aren't</span>
        <span class="kd">val</span> <span class="py">client</span> <span class="p">=</span> <span class="nc">OkHttpClient</span><span class="p">().</span><span class="nf">newBuilder</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">apply</span> <span class="p">{</span>
                <span class="nf">connectTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
                <span class="nf">callTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
                <span class="nf">readTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
                <span class="nf">writeTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="n">interceptors</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span>
            <span class="n">client</span><span class="p">.</span><span class="nf">addInterceptor</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="nf">build</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nd">@Provides</span>
    <span class="nd">@Singleton</span>
    <span class="k">fun</span> <span class="nf">retrofitClient</span><span class="p">(</span>
        <span class="n">moshiConverterFactory</span><span class="p">:</span> <span class="nc">MoshiConverterFactory</span><span class="p">,</span>
        <span class="n">okHttpClient</span><span class="p">:</span> <span class="nc">OkHttpClient</span>

    <span class="p">)</span> <span class="p">=</span> <span class="nc">Retrofit</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
        <span class="p">.</span><span class="nf">addConverterFactory</span><span class="p">(</span><span class="n">moshiConverterFactory</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="n">okHttpClient</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">baseUrl</span><span class="p">(</span><span class="nc">TestApi</span><span class="p">.</span><span class="nc">BASE_URL</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">build</span><span class="p">().</span><span class="n">create</span><span class="p">&lt;</span><span class="nc">TestApi</span><span class="p">&gt;()</span>
<span class="p">}</span>
</pre></table></code></div></div><p>and now we have</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="nc">SingletonComponent</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">object</span> <span class="nc">RetrofitModule</span> <span class="p">{</span>


    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">moshiConverterFactory</span><span class="p">()</span> <span class="p">=</span> <span class="nc">MoshiConverterFactory</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>


    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">okHttpClientConfiguration</span><span class="p">(</span>
        <span class="n">interceptors</span><span class="p">:</span> <span class="nc">Set</span><span class="p">&lt;</span><span class="err">@</span><span class="nc">JvmSuppressWildcards</span> <span class="nc">Interceptor</span><span class="p">&gt;</span>
    <span class="p">):</span> <span class="nc">OkHttpClient</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">timeout</span> <span class="p">=</span> <span class="mi">10L</span> <span class="c1">//even this can be provided</span>
        <span class="kd">val</span> <span class="py">timeUnit</span> <span class="p">=</span> <span class="nc">TimeUnit</span><span class="p">.</span><span class="nc">SECONDS</span> <span class="c1">//even this too, but for the sake of keeping this short we  aren't</span>
        <span class="kd">val</span> <span class="py">client</span> <span class="p">=</span> <span class="nc">OkHttpClient</span><span class="p">().</span><span class="nf">newBuilder</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">apply</span> <span class="p">{</span>
                <span class="nf">connectTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
                <span class="nf">callTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
                <span class="nf">readTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
                <span class="nf">writeTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">timeUnit</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="n">interceptors</span><span class="p">.</span><span class="nf">forEach</span> <span class="p">{</span>
            <span class="n">client</span><span class="p">.</span><span class="nf">addInterceptor</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">client</span><span class="p">.</span><span class="nf">build</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nd">@Provides</span>
    <span class="nd">@Singleton</span>
    <span class="k">fun</span> <span class="nf">retrofitClient</span><span class="p">(</span>
        <span class="n">moshiConverterFactory</span><span class="p">:</span> <span class="nc">MoshiConverterFactory</span><span class="p">,</span>
        <span class="n">okHttpClient</span><span class="p">:</span> <span class="nc">OkHttpClient</span>

    <span class="p">)</span> <span class="p">=</span> <span class="nc">Retrofit</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
        <span class="p">.</span><span class="nf">addConverterFactory</span><span class="p">(</span><span class="n">moshiConverterFactory</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="n">okHttpClient</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">baseUrl</span><span class="p">(</span><span class="nc">TestApi</span><span class="p">.</span><span class="nc">BASE_URL</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">build</span><span class="p">().</span><span class="n">create</span><span class="p">&lt;</span><span class="nc">TestApi</span><span class="p">&gt;()</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nd">@InstallIn</span><span class="p">(</span><span class="nc">SingletonComponent</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
</pre></table></code></div></div><p>Means that everything in this module will be scoped to the <code class="language-plaintext highlighter-rouge">SingletonComponent</code> that we’ve mentioned above.</p><p>Let’s go and annotate our <code class="language-plaintext highlighter-rouge">InterceptorsModule</code> with the same annotation</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="nc">SingletonComponent</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">object</span> <span class="nc">InterceptorsModule</span> <span class="p">{</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
</pre></table></code></div></div><h2 id="viewmodel">ViewModel</h2><p>Next to refactor is our <code class="language-plaintext highlighter-rouge">TestViewModel</code> which looks like this</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">TestViewModel</span> <span class="nd">@AssistedInject</span> <span class="k">constructor</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">testApi</span><span class="p">:</span> <span class="nc">TestApi</span><span class="p">,</span>
    <span class="nd">@Assisted</span> <span class="k">private</span> <span class="kd">val</span> <span class="py">savedStateHandle</span><span class="p">:</span> <span class="nc">SavedStateHandle</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>

    <span class="nd">@AssistedFactory</span>
    <span class="kd">interface</span> <span class="nc">TestViewModelFactory</span> <span class="p">{</span>
        <span class="k">fun</span> <span class="nf">create</span><span class="p">(</span><span class="n">savedStateHandle</span><span class="p">:</span> <span class="nc">SavedStateHandle</span><span class="p">):</span> <span class="nc">TestViewModel</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">listData</span><span class="p">:</span> <span class="nc">MutableStateFlow</span><span class="p">&lt;</span><span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;&gt;</span> <span class="p">=</span>
        <span class="nc">MutableStateFlow</span><span class="p">(</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Loading</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">list</span> <span class="p">=</span> <span class="n">listData</span><span class="p">.</span><span class="nf">asStateFlow</span><span class="p">()</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">listData</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="k">try</span> <span class="p">{</span>
                <span class="nf">transformPosts</span><span class="p">(</span><span class="n">testApi</span><span class="p">.</span><span class="nf">getPostsAdapter</span><span class="p">())</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">throwable</span><span class="p">:</span> <span class="nc">Throwable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Exception</span><span class="p">(</span><span class="n">throwable</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"HANDLE"</span><span class="p">,</span> <span class="n">savedStateHandle</span><span class="p">.</span><span class="nf">keys</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">transformPosts</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nc">Response</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;):</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">isSuccessful</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Success</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">()</span> <span class="o">?:</span> <span class="nf">emptyList</span><span class="p">())</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">ApiError</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">code</span><span class="p">(),</span> <span class="n">response</span><span class="p">.</span><span class="nf">errorBody</span><span class="p">())</span>
        <span class="p">}</span>


    <span class="k">sealed</span> <span class="kd">class</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="k">out</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="kd">data class</span> <span class="nc">Exception</span><span class="p">(</span><span class="kd">val</span> <span class="py">throwable</span><span class="p">:</span> <span class="nc">Throwable</span><span class="p">)</span> <span class="p">:</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">&gt;()</span>
        <span class="kd">data class</span> <span class="nc">ApiError</span><span class="p">(</span><span class="kd">val</span> <span class="py">responseCode</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="kd">val</span> <span class="py">errorBody</span><span class="p">:</span> <span class="nc">ResponseBody</span><span class="p">?)</span> <span class="p">:</span>
            <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">&gt;()</span>

        <span class="kd">data class</span> <span class="nc">Success</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="kd">val</span> <span class="py">data</span><span class="p">:</span> <span class="nc">T</span><span class="p">)</span> <span class="p">:</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;()</span>
        <span class="kd">object</span> <span class="nc">Loading</span> <span class="p">:</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">&gt;()</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>and now we have</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="nd">@HiltViewModel</span>
<span class="kd">class</span> <span class="nc">TestViewModel</span> <span class="nd">@Inject</span> <span class="k">constructor</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">testApi</span><span class="p">:</span> <span class="nc">TestApi</span><span class="p">,</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">savedStateHandle</span><span class="p">:</span> <span class="nc">SavedStateHandle</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">val</span> <span class="py">listData</span><span class="p">:</span> <span class="nc">MutableStateFlow</span><span class="p">&lt;</span><span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;&gt;</span> <span class="p">=</span>
        <span class="nc">MutableStateFlow</span><span class="p">(</span><span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Loading</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">list</span> <span class="p">=</span> <span class="n">listData</span><span class="p">.</span><span class="nf">asStateFlow</span><span class="p">()</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">listData</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="k">try</span> <span class="p">{</span>
                <span class="nf">transformPosts</span><span class="p">(</span><span class="n">testApi</span><span class="p">.</span><span class="nf">getPostsAdapter</span><span class="p">())</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">throwable</span><span class="p">:</span> <span class="nc">Throwable</span><span class="p">)</span> <span class="p">{</span>
                <span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Exception</span><span class="p">(</span><span class="n">throwable</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nc">Log</span><span class="p">.</span><span class="nf">d</span><span class="p">(</span><span class="s">"HANDLE"</span><span class="p">,</span> <span class="n">savedStateHandle</span><span class="p">.</span><span class="nf">keys</span><span class="p">().</span><span class="nf">toString</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">fun</span> <span class="nf">transformPosts</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nc">Response</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;):</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">TestModel</span><span class="p">&gt;&gt;</span> <span class="p">=</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">isSuccessful</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">Success</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">()</span> <span class="o">?:</span> <span class="nf">emptyList</span><span class="p">())</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nc">SimpleResult</span><span class="p">.</span><span class="nc">ApiError</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">code</span><span class="p">(),</span> <span class="n">response</span><span class="p">.</span><span class="nf">errorBody</span><span class="p">())</span>
        <span class="p">}</span>


    <span class="k">sealed</span> <span class="kd">class</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="k">out</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="kd">data class</span> <span class="nc">Exception</span><span class="p">(</span><span class="kd">val</span> <span class="py">throwable</span><span class="p">:</span> <span class="nc">Throwable</span><span class="p">)</span> <span class="p">:</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">&gt;()</span>
        <span class="kd">data class</span> <span class="nc">ApiError</span><span class="p">(</span><span class="kd">val</span> <span class="py">responseCode</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="kd">val</span> <span class="py">errorBody</span><span class="p">:</span> <span class="nc">ResponseBody</span><span class="p">?)</span> <span class="p">:</span>
            <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">&gt;()</span>

        <span class="kd">data class</span> <span class="nc">Success</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span><span class="kd">val</span> <span class="py">data</span><span class="p">:</span> <span class="nc">T</span><span class="p">)</span> <span class="p">:</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;()</span>
        <span class="kd">object</span> <span class="nc">Loading</span> <span class="p">:</span> <span class="nc">SimpleResult</span><span class="p">&lt;</span><span class="nc">Nothing</span><span class="p">&gt;()</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">@HiltViewModel</code>’s annotation makes the view model aware of the <code class="language-plaintext highlighter-rouge">SingletonComponent</code> and <code class="language-plaintext highlighter-rouge">ActivityRetainedComponent</code> dependencies, which in this case</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="kd">val</span> <span class="py">savedStateHandle</span><span class="p">:</span> <span class="nc">SavedStateHandle</span>
</pre></table></code></div></div><p>is a default one alongside</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="kd">val</span> <span class="py">application</span><span class="p">:</span> <span class="nc">Application</span>
</pre></table></code></div></div><p>from the factory that’s generated for each view model.</p><h2 id="applicationcontext">ApplicationContext</h2><p>if we build our project, we will notice that we deleted our <code class="language-plaintext highlighter-rouge">@ApplicationContext</code> qualifier, but no worries, Hilt comes with the same Qualifier for accessing the application context, head over to the <code class="language-plaintext highlighter-rouge">SharedPreferencesManager</code> and just import</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">dagger.hilt.android.qualifiers.ApplicationContext</span>
</pre></table></code></div></div><p>Clean the project and build it, notice that we deleted most of the things and changing just minimal things in order for everything to work the way it was without a lot of boilerplate, Hilt does that for you.</p><h2 id="downside">Downside</h2><hr /><p>The downside to this is <em>KAPT</em>, which adds to the build time, hopefully in the future we’ll get <em>KSP</em> migration which’ll help a lot with the build overhead.</p><h2 id="up-next">Up next</h2><hr /><p>In the next part we’ll see how to add our custom component, then how we can access dependencies from other modules using Hilt, assisted inject with Hilt, after that we’ll explore how Hilt plays with <em>Compose UI</em> or we should be looking at other solutions.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/hilt/1/hilt_2.jpeg" class="center" /></p><p>PS: The Android team provided a <a href="https://developer.android.com/training/dependency-injection/hilt-cheatsheet">cheat sheet</a> for Hilt, you can glance over it.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hilt/'>Hilt</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hilt/" class="post-tag no-text-decoration" >Hilt</a> <a href="/tags/kotlin/" class="post-tag no-text-decoration" >Kotlin</a> <a href="/tags/android/" class="post-tag no-text-decoration" >Android</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hilt to the rescue, part 1 - FunkyMuse&url=https://funkymuse.github.io/posts/hilt-part-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hilt to the rescue, part 1 - FunkyMuse&u=https://funkymuse.github.io/posts/hilt-part-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hilt to the rescue, part 1 - FunkyMuse&url=https://funkymuse.github.io/posts/hilt-part-1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://funkymuse.github.io/posts/hilt-part-1/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="http://www.reddit.com/submit?url=https://funkymuse.github.io/posts/hilt-part-1/&title=Hilt to the rescue, part 1 - FunkyMuse" data-toggle="tooltip" data-placement="top" title="Reddit" target="_blank" rel="noopener" aria-label="Reddit"> <i class="fa-fw fab fa-reddit"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/dagger/">Dagger</a> <a class="post-tag" href="/tags/hilt/">Hilt</a> <a class="post-tag" href="/tags/gradle/">Gradle</a> <a class="post-tag" href="/tags/architecture-components/">Architecture Components</a> <a class="post-tag" href="/tags/compose/">Compose</a> <a class="post-tag" href="/tags/jetpack/">Jetpack</a> <a class="post-tag" href="/tags/optimizations/">Optimizations</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/hilt-part-2/"><div class="card-body"> <span class="timeago small" > Jun 6 <i class="unloaded">2021-06-06T11:55:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hilt to the rescue, part 2</h3><div class="text-muted small"><p> In the previous post Part #1, we’ve explored how to set up Hilt, the pre-defined components that come with it and migrated to Hilt from our Dagger sample. In this blog post we’ll explore how to ...</p></div></div></a></div><div class="card"> <a href="/posts/compose_hilt_mm/"><div class="card-body"> <span class="timeago small" > Jul 4 <i class="unloaded">2021-07-04T11:55:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Navigation in multi module Android Compose UI project + Hilt</h3><div class="text-muted small"><p> If you’ve written an Android application you must have had some form of navigation inside your project, whether that’s manually starting Activities or managing Fragment transactions on your own (...</p></div></div></a></div><div class="card"> <a href="/posts/dagger-part-5/"><div class="card-body"> <span class="timeago small" > Mar 29 <i class="unloaded">2021-03-29T22:45:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dagger2 is hard, but it can be easy, part 5</h3><div class="text-muted small"><p> In the previous post we’ve explored scope operators. In this post we’ll encounter subcomponents and their hierarchy, custom scopes and let’s not waste any time. Starting off by including the an...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dagger-part-7/" class="btn btn-outline-primary" prompt="Older"><p>Dagger2 is hard, but it can be easy, part 7</p></a> <a href="/posts/hilt-part-2/" class="btn btn-outline-primary" prompt="Newer"><p>Hilt to the rescue, part 2</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/funky_muse">FunkyMuse</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/dagger/">Dagger</a> <a class="post-tag" href="/tags/hilt/">Hilt</a> <a class="post-tag" href="/tags/gradle/">Gradle</a> <a class="post-tag" href="/tags/architecture-components/">Architecture Components</a> <a class="post-tag" href="/tags/compose/">Compose</a> <a class="post-tag" href="/tags/jetpack/">Jetpack</a> <a class="post-tag" href="/tags/optimizations/">Optimizations</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://funkymuse.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
